(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[1954],{5784:(e,r,s)=>{"use strict";s.r(r),s.d(r,{default:()=>v});var t=s(95155);s(19324);var a=s(6874),o=s.n(a),l=s(12115),i=s(35695),n=s(79971),c=s(55988);function d(e){let{children:r,requiredRole:s=null}=e,a=(0,i.useRouter)(),[o,d]=(0,l.useState)(!1),[m,u]=(0,l.useState)(!0);return((0,l.useEffect)(()=>{if(!(0,n.getCookie)("token")){d(!1),a.push("/login");return}(async()=>{try{let e=await c.A.me();if(e.error)throw Error("Error al obtener informaci\xf3n del usuario");if((0,n.getCookie)("user")||(0,n.setCookie)("user",JSON.stringify(e.user),{maxAge:2592e3,path:"/"}),(0,n.getCookie)("empleado")||(0,n.setCookie)("empleado",JSON.stringify(e.empleado),{maxAge:2592e3,path:"/"}),(0,n.getCookie)("rol")||(0,n.setCookie)("rol",e.rol,{maxAge:2592e3,path:"/"}),s&&!(s&&s.includes(",")?s.split(",").map(e=>e.trim()):s?[s]:[]).some(e=>c.A.hasRole(e))){a.push("/dashboard/unauthorized"),d(!1);return}d(!0)}catch(e){console.error("Error de autenticaci\xf3n:",e),c.A.logoutClient(a),d(!1)}finally{u(!1)}})()},[a,s]),m)?(0,t.jsx)("div",{className:"flex h-screen w-full items-center justify-center",children:(0,t.jsx)("div",{className:"animate-spin rounded-full h-32 w-32 border-t-2 border-b-2 border-purple-500"})}):o?(0,t.jsx)(t.Fragment,{children:r}):null}var m=s(19864),u=s(73158),h=s(18186),p=s(50286),x=s(19637),g=s(11133),y=s(94063),f=s(15300),k=s(40157);let b=(0,k.A)("Settings",[["path",{d:"M12.22 2h-.44a2 2 0 0 0-2 2v.18a2 2 0 0 1-1 1.73l-.43.25a2 2 0 0 1-2 0l-.15-.08a2 2 0 0 0-2.73.73l-.22.38a2 2 0 0 0 .73 2.73l.15.1a2 2 0 0 1 1 1.72v.51a2 2 0 0 1-1 1.74l-.15.09a2 2 0 0 0-.73 2.73l.22.38a2 2 0 0 0 2.73.73l.15-.08a2 2 0 0 1 2 0l.43.25a2 2 0 0 1 1 1.73V20a2 2 0 0 0 2 2h.44a2 2 0 0 0 2-2v-.18a2 2 0 0 1 1-1.73l.43-.25a2 2 0 0 1 2 0l.15.08a2 2 0 0 0 2.73-.73l.22-.39a2 2 0 0 0-.73-2.73l-.15-.08a2 2 0 0 1-1-1.74v-.5a2 2 0 0 1 1-1.74l.15-.09a2 2 0 0 0 .73-2.73l-.22-.38a2 2 0 0 0-2.73-.73l-.15.08a2 2 0 0 1-2 0l-.43-.25a2 2 0 0 1-1-1.73V4a2 2 0 0 0-2-2z",key:"1qme2f"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]);var j=s(91721);let w=(0,k.A)("Sun",[["circle",{cx:"12",cy:"12",r:"4",key:"4exip2"}],["path",{d:"M12 2v2",key:"tus03m"}],["path",{d:"M12 20v2",key:"1lh1kg"}],["path",{d:"m4.93 4.93 1.41 1.41",key:"149t6j"}],["path",{d:"m17.66 17.66 1.41 1.41",key:"ptbguv"}],["path",{d:"M2 12h2",key:"1t8f8n"}],["path",{d:"M20 12h2",key:"1q8mjw"}],["path",{d:"m6.34 17.66-1.41 1.41",key:"1m8zz5"}],["path",{d:"m19.07 4.93-1.41 1.41",key:"1shlcs"}]]),N=(0,k.A)("Moon",[["path",{d:"M12 3a6 6 0 0 0 9 9 9 9 0 1 1-9-9Z",key:"a7tn18"}]]),C=(0,k.A)("LogOut",[["path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4",key:"1uf3rs"}],["polyline",{points:"16 17 21 12 16 7",key:"1gabdz"}],["line",{x1:"21",x2:"9",y1:"12",y2:"12",key:"1uyos4"}]]);function v(e){let{children:r}=e,s=(0,i.useRouter)(),a=(0,i.usePathname)(),o=(0,n.getCookie)("rol")||"Usuario",k=(0,n.getCookie)("user")?JSON.parse((0,n.getCookie)("user")):{name:"Usuario"},v=(0,n.getCookie)("empleado")?JSON.parse((0,n.getCookie)("empleado")):null,[S,E]=(0,l.useState)((null==v?void 0:v.nombre)||(null==k?void 0:k.name)||"Usuario"),[P,M]=(0,l.useState)(!1),[O,z]=(0,l.useState)(!0),[R,J]=(0,l.useState)(!1);(0,l.useEffect)(()=>{let e="true"===localStorage.getItem("darkMode");J(e),document.documentElement.classList.toggle("dark",e)},[]),(0,l.useEffect)(()=>{document.documentElement.classList.toggle("dark",R),localStorage.setItem("darkMode",R.toString())},[R]);let H=()=>{J(e=>!e)},_=async()=>{M(!0);try{await c.A.logout(),setTimeout(()=>c.A.logoutClient(s),350)}catch(e){console.error("Error al cerrar sesi\xf3n:",e),setTimeout(()=>c.A.logoutClient(s),1e3)}};return(0,t.jsx)(m.n.Provider,{value:{displayName:S,updateDisplayName:E},children:(0,t.jsx)(d,{children:(0,t.jsxs)("div",{className:"flex h-screen bg-gray-50 dark:bg-gray-900",children:[(0,t.jsxs)("aside",{className:"".concat(O?"w-64":"w-20"," transition-all duration-300 fixed inset-y-0 left-0 z-50 flex flex-col bg-white dark:bg-gray-800 border-r border-gray-200 dark:border-gray-700 shadow-lg"),children:[(0,t.jsxs)("div",{className:"flex items-center justify-between h-16 px-4 border-b border-gray-200 dark:border-gray-700",children:[(0,t.jsx)("div",{className:"flex items-center",children:O&&(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)("img",{src:"/dashboard/main-icon.svg",alt:"Logo",className:"h-8 w-8"}),(0,t.jsx)("span",{className:"ml-2 text-lg font-semibold text-blue-primary dark:text-white",children:"Neon Led Publicidad"})]})}),(0,t.jsx)("button",{onClick:()=>z(!O),className:"btn-ghost-safe p-1 rounded-md",type:"button",children:(0,t.jsx)(u.A,{className:"h-5 w-5 transition-transform duration-300 ".concat(O?"rotate-180":"")})})]}),(0,t.jsx)("nav",{className:"flex-1 overflow-y-auto py-4 px-3",children:(0,t.jsxs)("ul",{className:"space-y-1",children:[(0,t.jsx)(A,{href:"/dashboard/main",title:"Secci\xf3n Principal",icon:(0,t.jsx)(h.A,{className:"h-5 w-5"}),isCollapsed:!O,isActive:"/dashboard/main"===a}),c.A.hasPermission("ver-empleados")&&(0,t.jsx)(A,{href:"/dashboard/empleados",title:"Empleados",icon:(0,t.jsx)(p.A,{className:"h-5 w-5"}),isCollapsed:!O,isActive:a.includes("/dashboard/empleados")}),c.A.hasPermission("ver-contactos")&&(0,t.jsx)(A,{href:"/dashboard/contactos",title:"Contactanos",icon:(0,t.jsx)(x.A,{className:"h-5 w-5"}),isCollapsed:!O,isActive:a.includes("/dashboard/contactos")}),c.A.hasPermission("ver-modales")&&(0,t.jsx)(A,{href:"/dashboard/modales",title:"Modales",icon:(0,t.jsx)(g.A,{className:"h-5 w-5"}),isCollapsed:!O,isActive:a.includes("/dashboard/modales")}),c.A.hasPermission("ver-reclamaciones")&&(0,t.jsx)(A,{href:"/dashboard/reclamaciones",title:"Reclamaciones",icon:(0,t.jsx)(y.A,{className:"h-5 w-5"}),isCollapsed:!O,isActive:a.includes("/dashboard/reclamaciones")}),c.A.hasPermission("crear-blogs")&&(0,t.jsx)(A,{href:"/dashboard/blogs",title:"Blogs",icon:(0,t.jsx)(f.A,{className:"h-5 w-5"}),isCollapsed:!O,isActive:a.includes("/dashboard/blogs")}),c.A.hasRole("administrador")&&c.A.isVerifiedAccount()&&(0,t.jsx)(A,{href:"/dashboard/role-permission",title:"Roles y Permisos",icon:(0,t.jsx)(b,{className:"h-5 w-5"}),isCollapsed:!O,isActive:a.includes("/dashboard/role-permission")})]})}),(0,t.jsx)("div",{className:"p-4 border-t border-gray-200 dark:border-gray-700",children:O?(0,t.jsxs)("div",{className:"flex flex-col space-y-3",children:[(0,t.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,t.jsx)("div",{className:"flex-shrink-0",children:(0,t.jsx)("div",{className:"h-10 w-10 rounded-full bg-blue-primary flex items-center justify-center text-white",children:(0,t.jsx)(j.A,{className:"h-5 w-5"})})}),(0,t.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,t.jsx)("p",{className:"text-sm font-medium text-gray-900 dark:text-white truncate",children:S}),(0,t.jsx)("p",{className:"text-xs text-gray-500 dark:text-gray-400 truncate",children:o})]})]}),(0,t.jsxs)("div",{className:"flex items-center justify-between",children:[(0,t.jsx)("button",{onClick:H,className:"btn-ghost-safe p-2 rounded-md",type:"button",children:R?(0,t.jsx)(w,{className:"h-5 w-5"}):(0,t.jsx)(N,{className:"h-5 w-5"})}),(0,t.jsx)("button",{onClick:_,disabled:P,className:"btn-safe flex items-center justify-center px-3 py-2 text-sm font-medium rounded-md text-white bg-blue-primary hover:bg-blue-dark transition-colors disabled:opacity-70",type:"button",children:P?(0,t.jsxs)("div",{className:"flex items-center",children:[(0,t.jsxs)("svg",{className:"animate-spin -ml-1 mr-2 h-4 w-4 text-white",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[(0,t.jsx)("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),(0,t.jsx)("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),(0,t.jsx)("span",{children:"Saliendo..."})]}):(0,t.jsxs)("div",{className:"flex items-center",children:[(0,t.jsx)(C,{className:"h-4 w-4 mr-2"}),(0,t.jsx)("span",{children:"Cerrar sesi\xf3n"})]})})]})]}):(0,t.jsxs)("div",{className:"flex flex-col items-center space-y-4",children:[(0,t.jsx)("div",{className:"h-10 w-10 rounded-full bg-blue-primary flex items-center justify-center text-white",children:(0,t.jsx)(j.A,{className:"h-5 w-5"})}),(0,t.jsx)("button",{onClick:H,className:"btn-ghost-safe p-2 rounded-md",type:"button",children:R?(0,t.jsx)(w,{className:"h-5 w-5"}):(0,t.jsx)(N,{className:"h-5 w-5"})}),(0,t.jsx)("button",{onClick:_,disabled:P,className:"btn-safe p-2 rounded-md text-white bg-blue-primary hover:bg-blue-dark transition-colors disabled:opacity-70",type:"button",children:P?(0,t.jsxs)("svg",{className:"animate-spin h-5 w-5",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[(0,t.jsx)("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),(0,t.jsx)("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}):(0,t.jsx)(C,{className:"h-5 w-5"})})]})})]}),(0,t.jsxs)("div",{className:"flex-1 flex flex-col ".concat(O?"ml-64":"ml-20"," transition-all duration-300"),children:[(0,t.jsx)("header",{className:"z-10 h-16 flex items-center justify-between px-6 bg-white dark:bg-gray-800 border-b border-gray-200 dark:border-gray-700 shadow-sm",children:(0,t.jsx)("h1",{className:"text-xl font-semibold text-gray-800 dark:text-white",children:(()=>{if("/dashboard/main"===a)return"Panel Principal";let e=a.slice(a.indexOf("/",1)+1);return e.charAt(0).toUpperCase()+e.slice(1).replace(/-/g," ")})()})}),(0,t.jsx)("main",{className:"flex-1 overflow-auto bg-gray-50 dark:bg-gray-900 p-0",children:r})]})]})})})}function A(e){let{href:r,title:s,icon:a,isActive:l,isCollapsed:i}=e;return(0,t.jsx)("li",{children:(0,t.jsxs)(o(),{href:r,className:"btn-safe flex items-center ".concat(i?"justify-center":"justify-start"," p-2 rounded-lg transition-colors ").concat(l?"bg-blue-primary text-white":"text-gray-700 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-700"),children:[(0,t.jsx)("span",{className:"".concat(l?"text-white":"text-blue-primary dark:text-gray-300"),children:a}),!i&&(0,t.jsx)("span",{className:"ml-3",children:s})]})})}},11133:(e,r,s)=>{"use strict";s.d(r,{A:()=>t});let t=(0,s(40157).A)("CircleAlert",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]])},15300:(e,r,s)=>{"use strict";s.d(r,{A:()=>t});let t=(0,s(40157).A)("FileText",[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M10 9H8",key:"b1mrlr"}],["path",{d:"M16 13H8",key:"t4e002"}],["path",{d:"M16 17H8",key:"z1uh3a"}]])},18186:(e,r,s)=>{"use strict";s.d(r,{A:()=>t});let t=(0,s(40157).A)("House",[["path",{d:"M15 21v-8a1 1 0 0 0-1-1h-4a1 1 0 0 0-1 1v8",key:"5wwlr5"}],["path",{d:"M3 10a2 2 0 0 1 .709-1.528l7-5.999a2 2 0 0 1 2.582 0l7 5.999A2 2 0 0 1 21 10v9a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z",key:"1d0kgt"}]])},19324:()=>{},19637:(e,r,s)=>{"use strict";s.d(r,{A:()=>t});let t=(0,s(40157).A)("Mail",[["rect",{width:"20",height:"16",x:"2",y:"4",rx:"2",key:"18n3k1"}],["path",{d:"m22 7-8.97 5.7a1.94 1.94 0 0 1-2.06 0L2 7",key:"1ocrg3"}]])},19864:(e,r,s)=>{"use strict";s.d(r,{n:()=>t});let t=(0,s(12115).createContext)({displayName:"Usuario",updateDisplayName:()=>{}})},31670:(e,r,s)=>{"use strict";s.d(r,{A:()=>t});let t=s(49509).env.NEXT_PUBLIC_API_URL_PROD},35695:(e,r,s)=>{"use strict";var t=s(18999);s.o(t,"usePathname")&&s.d(r,{usePathname:function(){return t.usePathname}}),s.o(t,"useRouter")&&s.d(r,{useRouter:function(){return t.useRouter}}),s.o(t,"useSearchParams")&&s.d(r,{useSearchParams:function(){return t.useSearchParams}})},50286:(e,r,s)=>{"use strict";s.d(r,{A:()=>t});let t=(0,s(40157).A)("Users",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["path",{d:"M22 21v-2a4 4 0 0 0-3-3.87",key:"kshegd"}],["path",{d:"M16 3.13a4 4 0 0 1 0 7.75",key:"1da9ce"}]])},55988:(e,r,s)=>{"use strict";s.d(r,{A:()=>n});var t=s(31670),a=s(79971);let o="".concat(t.A,"/api"),l=function(e,r){let s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},t={path:"/",maxAge:86400,sameSite:"lax",...s};if("user"===e&&r&&"object"==typeof r){let s={id:r.id,name:r.name,email:r.email};(0,a.setCookie)(e,JSON.stringify(s),t);return}if("empleado"===e&&r&&"object"==typeof r){let s={id_empleado:r.id_empleado,nombre:r.nombre,apellido:r.apellido,email:r.email};(0,a.setCookie)(e,JSON.stringify(s),t);return}let o="object"==typeof r?JSON.stringify(r):r;(0,a.setCookie)(e,o,t)},i={register:async e=>{try{let r=await fetch("".concat(o,"/register"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)}),s=await r.json();if(!r.ok)throw Error(s.message||"Error en el registro");return s.user&&(0,a.setCookie)("user",JSON.stringify(s.user),{maxAge:86400}),s}catch(e){return console.error("Error en registro:",e),{error:!0,message:e.message}}},login:async e=>{try{let r=await fetch("".concat(o,"/login"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)}),s=await r.json();if(!r.ok)throw Error(s.message||"Error en la autenticaci\xf3n");return l("token",s.token),l("user",s.user),s.empleado&&l("empleado",s.empleado),s.rol&&l("rol",s.rol),s.permisos&&l("permisos",s.permisos),s}catch(e){throw console.error("Error en login:",e),e}},logout:async()=>{try{let e=(0,a.getCookie)("token");if(!e)return{success:!0};let r=await fetch("".concat(o,"/logout"),{method:"POST",headers:{authorization:"Bearer ".concat(e)}}),s=await r.json();if(!r.ok)throw Error(s.message||"Error al cerrar sesi\xf3n");return i.clearAuthCookies(),s}catch(e){return console.error("Error en logout:",e),i.clearAuthCookies(),{error:!0,message:e.message}}},me:async()=>{try{let e=(0,a.getCookie)("token");if(!e)return null;let r=await fetch("".concat(o,"/me"),{method:"GET",headers:{authorization:"Bearer ".concat(e)}}),s=await r.json();if(!r.ok)throw 401===r.status&&i.clearAuthCookies(),Error(s.message||"Error al obtener informaci\xf3n del usuario");return s.user&&l("user",s.user),s.empleado&&l("empleado",s.empleado),s.rol&&l("rol",s.rol),s.permisos&&l("permisos",s.permisos),s}catch(e){return console.error("Error al obtener informaci\xf3n del usuario:",e),{error:!0,message:e.message}}},logoutClient:e=>{i.clearAuthCookies(),e&&e.push("/login")},clearAuthCookies:()=>{(0,a.deleteCookie)("token"),(0,a.deleteCookie)("user"),(0,a.deleteCookie)("empleado"),(0,a.deleteCookie)("rol"),(0,a.deleteCookie)("permisos")},getCurrentUser:()=>{let e=(0,a.getCookie)("user");try{if(e)return"string"==typeof e?JSON.parse(e):e;return null}catch(e){return console.error("Error parsing user cookie:",e),null}},getCurrentEmpleado:()=>{let e=(0,a.getCookie)("empleado");try{if(e)return"string"==typeof e?JSON.parse(e):e;return null}catch(e){return console.error("Error parsing empleado cookie:",e),null}},getCurrentRole:()=>(0,a.getCookie)("rol")||null,getCurrentPermissions:()=>{let e=(0,a.getCookie)("permisos");try{return e?JSON.parse(e):[]}catch(e){return[]}},getToken:()=>(0,a.getCookie)("token"),hasRole:e=>{let r=i.getCurrentRole();return!!r&&r.toLowerCase()===e.toLowerCase()},hasPermission:e=>i.getCurrentPermissions().includes(e),hasAnyPermission:e=>{let r=i.getCurrentPermissions();return e.some(e=>r.includes(e))},isAdmin:()=>i.hasRole("administrador"),isAuthenticated:()=>!!(0,a.getCookie)("token"),refreshAuthData:async()=>await i.me(),isVerifiedAccount:()=>{let e=i.getCurrentUser();return(null==e?void 0:e.email)==="tmlighting@hotmail.com"}},n=i},73158:(e,r,s)=>{"use strict";s.d(r,{A:()=>t});let t=(0,s(40157).A)("ChevronRight",[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]])},91721:(e,r,s)=>{"use strict";s.d(r,{A:()=>t});let t=(0,s(40157).A)("User",[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]])},94063:(e,r,s)=>{"use strict";s.d(r,{A:()=>t});let t=(0,s(40157).A)("MessageSquare",[["path",{d:"M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z",key:"1lielz"}]])},98846:(e,r,s)=>{Promise.resolve().then(s.bind(s,5784))}},e=>{var r=r=>e(e.s=r);e.O(0,[2533,6815,6874,8441,1684,7358],()=>r(98846)),_N_E=e.O()}]);